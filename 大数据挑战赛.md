##### 数据集下载

[数据下载链接&最底下](https://www.heywhale.com/org/bdc/competition/area/6662bf9a8d6c97c5d0c6bb10/content/2)

[比赛规则](D:\qq文件地址\赛题描述（20240615-更新标红）.pdf)

[数据](D:\研究生\12、竞赛\大数据挑战赛\2024\global)

【思考】

1）如果简单的话，是不是所有人都能得奖。如果不是，证明不简单。

2）提升解题速度和解题质量。

3）做完在做一定的笔记。随便，看自己心情。

4）选择自己觉得高效的方法。

5）！预测未来。

6）我要知道怎么做，才能进行创新好吧。做好为这些大模型软件充钱的准备。

7）发现了ChatGPT的一个问题，就是加入a对应1，b对应2的话。那么ChatGPT输出时就会把a对应为2，b对应为1。

## 数据处理

### 数据读取和预处理

#### 6/16 task1

##### 数据读取

.reshape()：将对应的数组的形状改变。

pd.DataFrame()：columns参数接受的数据类型，必须是对应的集合或数组类型。

##### 数据预处理

去重去空归一化

【思考】

①这些参数好像都是因变量，如何确定自变量

##### 数据的分析

* 这些数据是如何构建联系的。
  比如：1个小时有一个目标值，但是3个小时才有一个自变量，这种不对等的数据应该如何构建联系。

【思考】

* 对于任意的数据，是不是将有关系的两个系数矩阵拼接起来就可以得到结果。





## 模型选择

【思考】

1）如何选择模型，各个模型的优势是什么？
能不能让DL自动产生模型，并训练。

2）LSTM或者Transformer

### 如何构建模型

#### 6/16

【思考】

1）对于一个因变量和一个自变量的模型的构建

##### 简单的线性回归



#### 6/18 【task3】

* tfm数据集和测试集都是本身。好像是什么自回归？
* x轴就是数据本身，而y标签就是从x中截取的某些部分构成的。

##### 深度学习

* 训练模式：
  ①在训练模式下，模型会应用所有在定义时设置的随机性操作，例如随机丢弃神经元的Dropout层。
  ②训练模式是模型学习参数的阶段，通常在前向传播之后会计算损失函数，并进行反向传播来更新网络的权重。
* 评估模式：
  ①评估模式用于模型的验证和测试阶段。在此模式下，所有随机性操作将被禁用，以确保每次评估模型时结果的一致性。例如，Dropout层在评估模式下不会丢弃任何神经元，Batch Normalization将使用移动平均和方差而不是单个batch的统计数据。



### 时间序列数据

#### 6/16

* 应该选择，transformer或者LSTM模型来解决问题。

#### 6/18

##### 绘制时间序列图

#### 6/19【task4】

##### 回归任务和分类任务

![image-20240619223814451](大数据挑战赛/image-20240619223814451.png)

![image-20240619223830686](大数据挑战赛/image-20240619223830686.png)

【思考】

* 所以，对于回归任务，我们的评价标准才是对应的准确度。对于分类任务才考虑准确率和精确度。这也从某些方面反映了卷积神经网络，为什么要接一个全连接层的原因。
* 图的回归任务是否准确反映在时序图上面。

##### 数组api

* [].extend(iterable)：表示将可迭代的对象压入对应的数组当中。



## 训练

【思考】

1）数据量特别大，应该如何训练。



## 任务

![image-20240622111441257](大数据挑战赛/image-20240622111441257.png)

五级标题 | taskn ≈ 任务

- [x] 【task1】.npy数据的打开，并转换为对应的pd.df格式。
- [x] 【task2】绘制时间序列图。
- [x] 【task3】tfm模型拟合伪数据。
- [x] 【task4】对模型拟合的数据进行预测，并进行结果的展示；分析回归的准确度；测试代码。
- [x] 【task5】解决维度不匹配的问题，为什么输出的targets有100，但是预测值只有25。
- [x] 【task6】如何判断时序数据拟合的效果。如何通过损失函数决定训练是否提前终止。
  详情见：D:\研究生\13、代码复现报告\1、机器学习复现报告\2、模型训练报告.doc
- [ ] 【task7】标准的向量经过Transformer之后如何进行转换的。这些向量维度的变换。
- [x] 【task8】绘制损失函数图像；保存python中的变量为文件，供给后续绘图。
  详情见：D:\研究生\13、代码复现报告\1、机器学习复现报告\2、模型训练报告.doc
- [ ] 【task9】transformer 如何拟合多对多的数据；对真实数据的拟合。
  拟合时序数据。
- [ ] 【task10】复现CSDN的代码，并理解。
  ①为什么需要seq_len和参batch数，它们的作用是什么？
  ②



### 6/22

#### task5

训练的轮数为：一次训练的图片的数量 x 迭代的次数。

修改前：

![image-20240622101108322](大数据挑战赛/image-20240622101108322.png)

修改后：

![image-20240622101046856](大数据挑战赛/image-20240622101046856.png)

【思考】

①之所以会出现task5任务中的情况，是因为数据进行拟合的情况下，是进行一个批次的拟合。所以需要对于每一个Input里面的内容进行预测，然后，进行预测即可。



#### task6

【思考】

* 对于线性回归的预测，那些指标可以用于判断回归的好坏。有了这些指标，我们应该如何判断和使用这些指标。
* 还是没能很好的理解这些评价指标

![image-20240622105327858](大数据挑战赛/image-20240622105327858.png)

【思考】模型评估和模型验证的区别。

* 模型评估是根据模型训练而言的，通过某些指标来判断。
* 模型验证是通过验证集的结果来看的。

![image-20240622102344207](大数据挑战赛/image-20240622102344207.png)



##### 模型的提前中止

如果发现损失函数在某个点处出现最小值，最后的损失函数却在时刻增大，考虑提前终止训练。已达到最好的效果



#### task9

多对多的数据中，输入维度体现为输入端的多维度。

那么这些数据的数据结构怎么处理。

##### 不同维度数据的拼接

![image-20240622203814902](大数据挑战赛/image-20240622203814902.png)

![image-20240622204234354](大数据挑战赛/image-20240622204234354.png)

【思考】

* 如果后续的输出需要前者的输入，则需要对应的模型架构。
  即，今天的风向会影响明天的风向，这种过去的数据影响将来时，则需要进行拼接。
* 内存分配的文件，当错误运行程序时为什么会被保存到C盘当中

【操作】

* 如果需要融合的话，需要先将这些矩阵进行其他的转换，在进行融合：
  ![image-20240622211517798](大数据挑战赛/image-20240622211517798.png)
  在融合的维度处可以不相同，但是非融合处一定要相同。图中的3850就是非融合处。



【最新思路】2024年6月23日11:28:04

* 对于这种特征张量和标签张量的合并，可以考虑使用
  torch.utils.data.TensorDataset来进行合并。这样可以节省很多事情。
  前提：至少存在一个维度是相等的。不相等的话，使用view进行维度的调整之后再进行拼接。
* 对于张量的和并需要遵循两条规则：
  1）维度相同；
  2）至少存在一个维度上面的值相同，且拼接的时候是在不同维度上拼接的，且除了不同维度以外的其他维度的值都要相同；

#### task10

* CSDN上面一篇关于时序数据的处理。

- [ ] 【subtask1】.pytest_cache是什么意思
  test_函数名，就会生成这个。暂时未知。

##### 数据预处理

##### 保存模型参数

* 回归任务模型的参数通常是1；

##### 观测指标

* 时序图的拟合情况；均方误差的大小(越小越好)。

##### tfm参数

* d_model参数的含义：
  ![image-20240623181553405](大数据挑战赛/image-20240623181553405.png)

##### torch.nn

![image-20240623183108143](大数据挑战赛/image-20240623183108143.png)

![image-20240623183115790](大数据挑战赛/image-20240623183115790.png)





## 其他

![image-20240616153148579](大数据挑战赛/image-20240616153148579.png)